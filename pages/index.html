<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>首頁</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/swiper/swiper-bundle.min.css"
    />
  </head>
  <body>
    <div class="phone-frame">
      <div class="phone-frame-relative">
        <div class="StatusBar"></div>
        <div class="phone-screen container py-5 bg-index">
          <!-- <%- include('./layout/header'); -%>? -->

          <!-- Content -->
          <main>
            <section class="stage">
              <div class="stage__wrap my-5">
                <!-- Swiper 主體 -->
                <div class="swiper myCoverflow mt-5">
                  <div class="swiper-wrapper">
                    <!-- Slide 1 -->
                    <div
                      class="swiper-slide"
                      data-key="ghost"
                      data-title="鬼才知道"
                      data-year="2022"
                      data-duration="114"
                      data-rating="6.8"
                      data-match="95%契合"
                      data-tags="奇幻冒險・歡樂喜劇"
                    >
                      <a class="slide-hit" href="#">
                        <img
                          class="slide-img"
                          src="/assets/images/page-emotion-recommendation/Movie-Excite-10.jpg"
                          alt="鬼才知道"
                        />
                      </a>
                    </div>

                    <!-- Slide 2 -->
                    <div
                      class="swiper-slide"
                      data-key="barbie"
                      data-title="芭比"
                      data-year="2022"
                      data-duration="114"
                      data-rating="6.8"
                      data-match="95%契合"
                      data-tags="奇幻冒險・歡樂喜劇"
                      data-top10
                    >
                      <a
                        class="slide-hit js-animate"
                        href="https://gccbs01002.github.io/Moodie/movie_info/barbie-info.html"
                      >
                        <img
                          class="slide-img"
                          src="/assets/images/page-emotion-recommendation/Movie-Excite-1.jpg"
                          alt="芭比"
                        />
                      </a>
                    </div>

                    <!-- Slide 3 -->
                    <div
                      class="swiper-slide"
                      data-key="money"
                      data-title="還錢"
                      data-year="2022"
                      data-duration="114"
                      data-rating="6.8"
                      data-match="95%契合"
                      data-tags="奇幻冒險・歡樂喜劇"
                    >
                      <a class="slide-hit" href="#">
                        <img
                          class="slide-img"
                          src="/assets/images/page-emotion-recommendation/Movie-Excite-11.jpg"
                          alt="還錢"
                        />
                      </a>
                    </div>

                    <!-- Slide 4 -->
                    <div
                      class="swiper-slide"
                      data-key="dance"
                      data-title="快樂的一天"
                      data-year="2022"
                      data-duration="114"
                      data-rating="6.8"
                      data-match="95%契合"
                      data-tags="奇幻冒險・歡樂喜劇"
                    >
                      <a class="slide-hit" href="#">
                        <img
                          class="slide-img"
                          src="/assets/images/page-emotion-recommendation/Movie-Excite-12.jpg"
                          alt="快樂的一天"
                        />
                      </a>
                    </div>

                    <!-- Slide 5 -->
                    <div
                      class="swiper-slide"
                      data-key="lee"
                      data-title="李小龍"
                      data-year="2022"
                      data-duration="114"
                      data-rating="6.8"
                      data-match="95%契合"
                      data-tags="奇幻冒險・歡樂喜劇"
                    >
                      <a class="slide-hit" href="#">
                        <img
                          class="slide-img"
                          src="/assets/images/page-emotion-recommendation/Movie-Excite-2.jpg"
                          alt="李小龍"
                        />
                      </a>
                    </div>

                    <!-- Slide 6 -->
                    <div
                      class="swiper-slide"
                      data-key="alien"
                      data-title="史迪奇"
                      data-year="2022"
                      data-duration="114"
                      data-rating="6.8"
                      data-match="95%契合"
                      data-tags="奇幻冒險・歡樂喜劇"
                    >
                      <a class="slide-hit" href="#">
                        <img
                          class="slide-img"
                          src="/assets/images/page-emotion-recommendation/Movie-Excite-3.jpg"
                          alt="史迪奇"
                        />
                      </a>
                    </div>
                  </div>
                  <!-- 分頁 -->
                  <div class="stage__wrap">
                    <div class="swiper myCoverflow">
                      <div class="swiper-pagination"></div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
            <!-- Modal：點中間圖開啟 -->
            <div
              id="galleryModal"
              class="modal"
              aria-hidden="true"
              role="dialog"
              aria-modal="true"
              aria-labelledby="modalTitle"
            >
              <div class="modal__backdrop" data-close="true"></div>
              <div class="modal__dialog" role="document">
                <button
                  class="modal__close"
                  aria-label="Close"
                  data-close="true"
                >
                  ×
                </button>
                <h2 id="modalTitle" class="modal__title"></h2>
                <div class="modal__body">
                  <img id="modalImg" alt="" />
                  <div id="modalText"></div>
                  <!-- ← 這裡我們用 JS 塞內容 -->
                </div>
              </div>
            </div>
          </main>
          <!-- <%- include('./layout/footer'); -%> -->
        </div>
        <footer class="Home-Indicator"></footer>
      </div>
      <img
        src="/assets/images/AppFrame/iPhone_15_Pro_Black_Titanium_Mock_Up(O).png"
        alt=""
        class="phone-overlay"
      />
    </div>
    <script type="module">
      // 初始化 Swiper（coverflow 效果）
      const swiper = new Swiper(".myCoverflow", {
        effect: "coverflow",
        grabCursor: true,
        centeredSlides: true,
        loop: true,
        slidesPerView: 3,
        speed: 500,
        coverflowEffect: {
          rotate: 0,
          stretch: 0,
          depth: 160,
          modifier: 1,
          slideShadows: false,
        },
        breakpoints: {
          0: { slidesPerView: 1.3, coverflowEffect: { depth: 80 } },
          576: { slidesPerView: 2.2, coverflowEffect: { depth: 120 } },
          992: { slidesPerView: 3, coverflowEffect: { depth: 180 } },
        },
      });

      // Modal 互動
      const modal = document.getElementById("galleryModal");
      const modalImg = document.getElementById("modalImg");
      const closeBtn = modal.querySelector(".modal__close");

      function openModal(imgSrc, alt = "") {
        modalImg.src = imgSrc;
        modalImg.alt = alt || "preview";
        modal.classList.add("is-open");
        modal.setAttribute("aria-hidden", "false");
        setTimeout(() => closeBtn.focus(), 0);
        document.documentElement.style.overflow = "hidden";
      }
      function closeModal() {
        modal.classList.remove("is-open");
        modal.setAttribute("aria-hidden", "true");
        document.documentElement.style.overflow = "";
      }

      modal.addEventListener("click", (e) => {
        if (e.target.matches("[data-close]")) closeModal();
      });
      window.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && modal.classList.contains("is-open"))
          closeModal();
      });

      // 僅在「中間（active 或 duplicate-active）」圖被點擊時開啟 Modal
      document.querySelector(".myCoverflow").addEventListener("click", (e) => {
        const activeImg = document.querySelector(
          ".myCoverflow .swiper-slide-active .slide-img, .myCoverflow .swiper-slide-duplicate-active .slide-img"
        );
        if (activeImg && activeImg.contains(e.target))
          openModal(activeImg.src, activeImg.alt || "");
      });
    </script>
    <script>
      document.getElementById("backBtn")?.addEventListener("click", () => {
        if (history.length > 1) history.back();
        else location.href = "/"; // 沒有上一頁時要回到的預設頁，改成你的首頁路徑
      });
    </script>
    <script type="module" src="/js/slide-overlay.js"></script>
    <script type="module" src="/main.js"></script>
  </body>
</html>
